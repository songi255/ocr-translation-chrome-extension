(()=>{"use strict";const e=new class{capture(e,t){const o=e.devicePixelRatio,n=Math.min(e.sx,e.ex)*o,s=Math.min(e.sy,e.ey)*o,a=Math.max(e.sx,e.ex)*o,r=Math.max(e.sy,e.ey)*o,c=a-n,i=r-s;chrome.tabs.captureVisibleTab({format:"png"},(e=>{const a=new OffscreenCanvas(c/o,i/o),r=a.getContext("2d");fetch(e).then((e=>e.blob())).then((e=>createImageBitmap(e))).then((e=>null==r?void 0:r.drawImage(e,n,s,c,i,0,0,c/o,i/o))).then((()=>a.convertToBlob())).then((e=>t(e)))}))}saveToFile(){}};chrome.runtime.onMessage.addListener(((t,o,n)=>{if(console.log("service worker recieved message from content.js"),console.log(t),"request-operation"===t.eventType)return e.capture(t.cropPos,(e=>{console.log(e);const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{const e=t.result;n({base64:e})}})),!0}))})();